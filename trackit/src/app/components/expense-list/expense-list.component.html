<div class="expense-list-container">
    <!-- Summary Cards -->
    <div class="summary-cards" fxLayout="row" fxLayout.xs="column" fxLayoutGap="16px">
      <mat-card class="summary-card" fxFlex="33" fxFlex.xs="100">
        <mat-card-content>
          <div class="summary-content" fxLayout="row" fxLayoutAlign="space-between center">
            <div>
              <h3>Total Expenses</h3>
              <p class="amount">${{ totalExpenses | number:'1.2-2' }}</p>
            </div>
            <mat-icon class="summary-icon total">account_balance_wallet</mat-icon>
          </div>
        </mat-card-content>
      </mat-card>
  
      <mat-card class="summary-card" fxFlex="33" fxFlex.xs="100">
        <mat-card-content>
          <div class="summary-content" fxLayout="row" fxLayoutAlign="space-between center">
            <div>
              <h3>This Month</h3>
              <p class="amount">${{ monthlyTotal | number:'1.2-2' }}</p>
            </div>
            <mat-icon class="summary-icon monthly">calendar_today</mat-icon>
          </div>
        </mat-card-content>
      </mat-card>
  
      <mat-card class="summary-card" fxFlex="33" fxFlex.xs="100">
        <mat-card-content>
          <div class="summary-content" fxLayout="row" fxLayoutAlign="space-between center">
            <div>
              <h3>Total Records</h3>
              <p class="amount">{{ expenses.length }}</p>
            </div>
            <mat-icon class="summary-icon records">receipt_long</mat-icon>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  
    <!-- Header -->
    <div class="header" fxLayout="row" fxLayoutAlign="space-between center">
      <h2>My Expenses</h2>
      <button mat-raised-button color="primary" (click)="openCreateExpenseDialog()">
        <mat-icon>add</mat-icon>
        Add Expense
      </button>
    </div>
  
    <!-- Expense Table with Tabs -->
    <mat-card class="expense-card">
      <mat-tab-group (selectedTabChange)="onTabChange($event.index)" animationDuration="300ms">
        <mat-tab label="All">
          <ng-container *ngTemplateOutlet="expenseTable"></ng-container>
        </mat-tab>
  
        <mat-tab label="Pending">
          <ng-container *ngTemplateOutlet="expenseTable"></ng-container>
        </mat-tab>
  
        <mat-tab label="Paid">
          <ng-container *ngTemplateOutlet="expenseTable"></ng-container>
        </mat-tab>
  
        <mat-tab label="Upcoming">
          <ng-container *ngTemplateOutlet="expenseTable"></ng-container>
        </mat-tab>
      </mat-tab-group>
    </mat-card>
  
    <!-- Loading Spinner -->
    <div *ngIf="isLoading" class="loading-container" fxLayout="column" fxLayoutAlign="center center">
      <mat-spinner></mat-spinner>
      <p>Loading expenses...</p>
    </div>
  </div>
  
  <!-- Expense Table Template -->
  <ng-template #expenseTable>
    <div class="tab-content">
      <div *ngIf="filteredExpenses.length === 0 && !isLoading" class="empty-state" fxLayout="column" fxLayoutAlign="center center">
        <mat-icon>receipt_long</mat-icon>
        <h3>No expenses found</h3>
        <p>Start by adding your first expense</p>
        <button mat-raised-button color="primary" (click)="openCreateExpenseDialog()">
          <mat-icon>add</mat-icon>
          Add Expense
        </button>
      </div>
  
      <mat-table [dataSource]="filteredExpenses" class="expense-table" *ngIf="filteredExpenses.length > 0">
        <ng-container matColumnDef="title">
          <mat-header-cell *matHeaderCellDef>Expense</mat-header-cell>
          <mat-cell *matCellDef="let expense">
            <div class="expense-info">
              <div class="expense-title">{{ expense.title }}</div>
              <div class="expense-description" *ngIf="expense.description">{{ expense.description }}</div>
            </div>
          </mat-cell>
        </ng-container>
  
        <ng-container matColumnDef="amount">
          <mat-header-cell *matHeaderCellDef>Amount</mat-header-cell>
          <mat-cell *matCellDef="let expense">
            <span class="amount-cell">${{ expense.amount | number:'1.2-2' }}</span>
          </mat-cell>
        </ng-container>
  
        <ng-container matColumnDef="category">
          <mat-header-cell *matHeaderCellDef>Category</mat-header-cell>
          <mat-cell *matCellDef="let expense">
            <div class="category-cell" fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="8px">
              <mat-icon class="category-icon">{{ getCategoryIcon(expense.category) }}</mat-icon>
              <span>{{ expense.category }}</span>
            </div>
          </mat-cell>
        </ng-container>
  
        <ng-container matColumnDef="date">
          <mat-header-cell *matHeaderCellDef>Date</mat-header-cell>
          <mat-cell *matCellDef="let expense">
            {{ expense.date | date:'MMM dd, yyyy' }}
          </mat-cell>
        </ng-container>
  
        <ng-container matColumnDef="status">
          <mat-header-cell *matHeaderCellDef>Status</mat-header-cell>
          <mat-cell *matCellDef="let expense">
            <mat-chip [color]="getStatusColor(expense.status)" selected class="status-chip">
              <mat-icon matChipAvatar>{{ getStatusIcon(expense.status) }}</mat-icon>
              {{ expense.status | titlecase }}
            </mat-chip>
          </mat-cell>
        </ng-container>
  
        <ng-container matColumnDef="actions">
          <mat-header-cell *matHeaderCellDef>Actions</mat-header-cell>
          <mat-cell *matCellDef="let expense">
            <button mat-icon-button (click)="editExpense(expense)" matTooltip="Edit expense">
              <mat-icon>edit</mat-icon>
            </button>
            <button mat-icon-button color="warn" (click)="deleteExpense(expense)" matTooltip="Delete expense">
              <mat-icon>delete</mat-icon>
            </button>
          </mat-cell>
        </ng-container>
  
        <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
        <mat-row *matRowDef="let row; columns: displayedColumns;" class="expense-row"></mat-row>
      </mat-table>
    </div>
  </ng-template>